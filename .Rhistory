geom_line(aes(sp, runtime/60, color=as.factor(n.psi))) +
theme_linedraw() +
scale_x_log10(breaks=unique(outframe2$sp), labels=unique(outframe2$sp),
minor_breaks=10^seq(0.5,3, 0.5),
sec.axis=dup_axis(~., labels = paste0(unique(outframe2$n0), "\n(",unique(outframe2$p),")"),
name="# samples where species may be absent\n(proportion)")) +
scale_y_log10(breaks=10^seq(-1,3,2), limits=c(0.01,1000), labels=c(0.01, 1, 1000)) +
geom_label(data=data.frame(x=10^seq(0.5,3, 0.5), y=0.01, n.form="6"), aes(x,y,label=round(x)),
size=3, nudge_y=0.2, color="grey80", label.padding = unit(0.15, "lines")) +
theme(panel.grid.major.x = element_line(color="grey20", size=0.2, linetype="dashed"),
panel.grid.minor.x = element_line(color="grey80", size=0.2),
panel.grid.minor.y = element_line(color="grey90", size=0.2),
panel.grid.major.y = element_line(color="grey60", size=0.2),
strip.text.y.right = element_text(angle=0),
axis.text.x.top = element_text(size=6)) +
labs(x="# species included in run (log scale)", y="Runtime (minutes)", color="# Psi assigned")
g2
ggplot(s1, aes(log10(sp), log10(runtime))) + geom_point() +
stat_smooth(method='lm',formula = 'y~x', color="blue", se=F) +
stat_smooth(method='lm',formula = 'y~asinh(x)', color="red", se=F) +
stat_smooth(method='lm',formula = 'y~log(x)', color="orange", se=F) +
stat_smooth(method='lm',formula = 'y~x^3', color="green", se=F)
ggplot(s1, aes(log10(sp), log10(runtime))) + geom_point() +
stat_smooth(method='lm',formula = 'y~x', color="blue", se=F) +
stat_smooth(method='lm',formula = 'y~asinh(x)', color="red", se=F) +
stat_smooth(method='lm',formula = 'y~log(x)', color="orange", se=F) +
stat_smooth(method='lm',formula = 'y~x^3', color="green", se=F)
ggplot(s1, aes(log10(sp), log10(runtime))) + geom_point() +
stat_smooth(method='lm',formula = 'y~x', color="blue", se=F) +
stat_smooth(method='lm',formula = 'y~asinh(x)', color="red", se=F) +
stat_smooth(method='lm',formula = 'y~log(x)', color="orange", se=F) +
stat_smooth(method='lm',formula = 'y~poly(x,3)', color="green", se=F)
m4 <- lm(log10(runtime) ~ poly(log10(sp),3), data=s1); summary(m4)
lm(log10(runtime) ~ poly(log10(sp),3), data=outframe) %>% summary()
View(outframe)
summary(m4)[[4]]
summary(m4)[[8]]
summary(m4)[[7]]
summary(m4)[[5]]
summary(m4)[[6]]
summary(m4)[[9]]
summary(m4)[[10]]
summary(m4)[c(9,10,11)]
View(summary(m4))
summary(m4)[c(9,10)]
summary(m)[[10]]
summary(m4)[[10]]
coef(m4)
o <- c(c,r,f)
head(outframe)
help(reframe)
test <- outframe %>% group_by(n.form,n.psi) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=interaction(n.form,n.psi))
pullcoef <- function(x, y){
m <- lm(log10(y) ~ poly(log10(x),3))
c <- coef(m)
r <- summary(m)[[9]]
f <- summary(m)[[10]]
o <- c(c,r,f)
return(o)
}
test <- outframe %>% group_by(n.form,n.psi) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=interaction(n.form,n.psi))
test <- outframe %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=interaction(n.form,n.psi))
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g)
View(test)
pullcoef <- function(x, y){
m <- lm(log10(y) ~ poly(log10(x),3))
c <- coef(m)
r <- summary(m)[[9]]
f <- summary(m)[[10]]
o <- data.frame(stat=names(c(c,r,f)),value=c(c,r,f))
return(o)
}
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g)
View(test)
pullcoef <- function(x, y){
m <- lm(log10(y) ~ poly(log10(x),3))
c <- coef(m)
r <- summary(m)[[9]] %>% `names<-`("adj.r.squared")
f <- summary(m)[[10]]
o <- data.frame(stat=names(c(c,r,f)),value=c(c,r,f))
return(o)
}
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g)
pullcoef <- function(x, y){
m <- lm(log10(y) ~ poly(log10(x),3))
c <- coef(m) %>% `names<-`(c("Intercept","x^1","x^2","x^3"))
r <- summary(m)[[9]] %>% `names<-`("adj.r.squared")
f <- summary(m)[[10]]
o <- data.frame(stat=names(c(c,r,f)),value=c(c,r,f))
return(o)
}
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g)
pullcoef <- function(x, y){
m <- lm(log10(y) ~ poly(log10(x),3))
c <- coef(m) %>% `names<-`(c("Intercept","x^1","x^2","x^3"))
r <- summary(m)[[9]] %>% `names<-`("adj.r.squared")
f <- summary(m)[[10]] %>% `names<-`(c("F.val","num.df","den.df"))
o <- data.frame(stat=names(c(c,r,f)),value=c(c,r,f))
return(o)
}
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g)
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g) %>%
reshape2::dcast(g ~ stat)
View(test)
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g) %>%
reshape2::dcast(g ~ stat) %>%
separate(g,c("n.form","n.psi"))
test <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g) %>%
reshape2::dcast(g ~ stat) %>%
separate(g,c("n.form","n.psi")) %>%
.[,c(1:2,6,8:10,5,7,4,3)]
View(test)
help(anova)
anova(m1,m2,m3,m4)
anova(m1,m2,m3,m4) %>% summary()
anova(m1,m2,m3,m4)
View(anova(m1,m2,m3,m4))
anova(m1,m4,m3,m2)
anova(m4,m1,m3,m2)
anova(m1,m2,m4,m3)
?anova.lm
anova(m4,m1,m2,m3)
anova(m1,m2,m3,m4)
help(BIC)
BIC(m1,m2,m3,m4)
testCoefs <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(pullcoef(log10(sp), log10(runtime)), .by=g) %>%
reshape2::dcast(g ~ stat) %>%
separate(g,c("n.form","n.psi")) %>%
.[,c(1:2,6,8:10,5,7,4,3)]
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
bestmod <- function(x,y){
m1 <- lm(log10(y) ~ log10(x))
m2 <- lm(log10(y) ~ asinh(log10(x)))
m3 <- lm(log10(y) ~ log(log10(x)))
m4 <- lm(log10(y) ~ poly(log10(x)))
a <- BIC(m1,m2,m3,m4)
o <- which(a$BIC==min(a$BIC))
return(paste("Model",o,"is the best model"))
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
View(testBIC)
bestmod <- function(x,y){
m1 <- lm(log10(y) ~ log10(x))
m2 <- lm(log10(y) ~ asinh(log10(x)))
m3 <- lm(log10(y) ~ log(log10(x)))
m4 <- lm(log10(y) ~ poly(log10(x)))
a <- BIC(m1,m2,m3,m4)
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC)
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
View(testBIC)
AIC(m1,m2,m3,m4)
head(outframe)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x)))
a <- AIC(ma,mb,mc,md)
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC)
return(o)
}
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x)))
a <- BIC(ma,mb,mc,md)
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC)
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
BIC(m1,m2,m3,m4)
b <- BIC(m1,m2,m3,m4)
b
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="x")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~"))
testBIC <- outframe %>% mutate(g=as.factor(paste(n.form, n.psi, sep="~"))) %>%
reframe(bestmod(sp, runtime), .by=g)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~"))
head(testBIC)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x)))
a <- BIC(ma,mb,mc,md)
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC)
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
m1 <- lm(log10(runtime) ~ log10(sp), data=s1); summary(m1)
m2 <- lm(log10(runtime) ~ asinh(log10(sp)), data=s1); summary(m2)
m3 <- lm(log10(runtime) ~ log(log10(sp)), data=s1); summary(m3)
m4 <- lm(log10(runtime) ~ poly(log10(sp),3), data=s1); summary(m4)
BIC(m1,m2,m3,m4)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
View(testBIC)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x),3))
a <- BIC(ma,mb,mc,md)
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC)
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x),3))
a <- BIC(ma,mb,mc,md)
b <- which(a$BIC==min(a$BIC))
o <- data.frame(model=paste0("m",1:4),BIC=a$BIC,best=paste0("model",b))
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x),3))
a <- BIC(ma,mb,mc,md)$BIC %>% `names<-`(paste0("m",1:4))
b <- paste0("model",which(a==min(a))) %>% `names<-`("best")
o <- c(a,b)
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ model)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x),3))
a <- BIC(ma,mb,mc,md)$BI %>% `names<-`
b <- paste0("model",which(a==min(a)))
o <- data.frame(vars=c(paste0("m",1:4),"best"), value=c(a,b))
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
bestmod <- function(x,y){
ma <- lm(log10(y) ~ log10(x))
mb <- lm(log10(y) ~ asinh(log10(x)))
mc <- lm(log10(y) ~ log(log10(x)))
md <- lm(log10(y) ~ poly(log10(x),3))
a <- BIC(ma,mb,mc,md)$BIC
b <- paste0("model",which(a==min(a)))
o <- data.frame(vars=c(paste0("m",1:4),"best"), value=c(a,b))
return(o)
}
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g)
View(testBIC)
testBIC <- outframe %>% mutate(g=paste(n.form, n.psi, sep="~")) %>%
reframe(bestmod(sp, runtime), .by=g) %>%
reshape2::dcast(g ~ vars)
View(testBIC)
View(testBIC)
View(testCoefs)
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>% mutate(g=paste(n.form, n.psi, sep="~"))) %>%
summary()
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>% mutate(g=paste(n.form, n.psi, sep="~"))) %>%
summary()
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>% mutate(g=paste(n.form, n.psi, sep="~")))
summary(m.whole)
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="3"))
summary(m.whole)
m.form3 <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="3"))
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*as.factor(n.form),
data=outframe)
summary(m.whole)
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*as.factor(n.psi),
data=outframe)
summary(m.whole)
View(testCoefs)
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)+n.psi+n.form,
data=outframe)
summary(m.whole)
m.whole <- lm(log10(runtime) ~ poly(log10(sp),3)*n.psi*n.form,
data=outframe)
summary(m.whole)
seq(1,1000,50)
seq(1,1000,50) %>% length()
newdata <- rbind(data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=1, n.form=1),
data.frame(pred="n.psi",sp=1, n.psi=1:10, n.form=1),
data.frame(pred="n.form",sp=1,n.psi=1,n.form=seq(1,20,2)))
View(newdata)
seq(1,20,2)
seq(2,20,2)
seq(2,20,2) %>% length()
newdata <- rbind(data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=1, n.form=2),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=5, n.form=2),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=10, n.form=2),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=1, n.form=11),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=5, n.form=11),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=10, n.form=11),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=1, n.form=20),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=5, n.form=20),
data.frame(pred="n.sp",sp=seq(1,1000,100), n.psi=10, n.form=20),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=20),
data.frame(pred="n.form",sp=10,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=10,n.form=seq(2,20,2)))
help(predict)
predict(m.whole, newdata, interval="prediction")
try <- predict(m.whole, newdata, interval="prediction")
View(try)
View(newdata)
newdata <- rbind(data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=1, n.form=2),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=5, n.form=2),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=10, n.form=2),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=1, n.form=11),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=5, n.form=11),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=10, n.form=11),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=1, n.form=20),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=5, n.form=20),
data.frame(pred="n.sp",sp=seq(0,1000,100), n.psi=10, n.form=20),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=20),
data.frame(pred="n.form",sp=10,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=10,n.form=seq(2,20,2)))
View(newdata)
try <- predict(m.whole, newdata, interval="prediction") %>% cbind(newdata)
View(try)
newdata <- rbind(data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=1, n.form=2),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=5, n.form=2),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=10, n.form=2),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=1, n.form=11),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=5, n.form=11),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=10, n.form=11),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=1, n.form=20),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=5, n.form=20),
data.frame(pred="n.sp",sp=round(10^seq(1,1000, length=10)), n.psi=10, n.form=20),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=20),
data.frame(pred="n.form",sp=10,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=10,n.form=seq(2,20,2)))
newdata <- rbind(data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=1, n.form=2),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=5, n.form=2),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=10, n.form=2),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=1, n.form=11),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=5, n.form=11),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=10, n.form=11),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=1, n.form=20),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=5, n.form=20),
data.frame(pred="n.sp",sp=round(seq(1,1000, length=10)), n.psi=10, n.form=20),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=2),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=11),
data.frame(pred="n.psi",sp=10, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=100, n.psi=1:10, n.form=20),
data.frame(pred="n.psi",sp=1000, n.psi=1:10, n.form=20),
data.frame(pred="n.form",sp=10,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=1,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=5,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=10,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=100,n.psi=10,n.form=seq(2,20,2)),
data.frame(pred="n.form",sp=1000,n.psi=10,n.form=seq(2,20,2)))
try <- predict(m.whole, newdata, interval="prediction") %>% cbind(newdata)
ggplot(try) + facet_grid(.~pred) +
geom_smooth(aes(sp, fit, color=n.psi, shape=n.form))
ggplot(try) + facet_grid(.~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), shape=as.factor(n.form)))
ggplot(try) + facet_grid(n.psi~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.form)))
ggplot(try) + facet_grid(.~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), shape=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(.~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), shape=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(.~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(n.psi~pred) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(pred~n.psi) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(pred~n.form) +
geom_smooth(aes(sp, fit, color=as.factor(n.psi), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.sp")) + facet_grid(pred~n.form) +
geom_smooth(aes(sp, 10^fit, color=as.factor(n.psi), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.psi")) + facet_grid(pred~n.form) +
geom_smooth(aes(n.psi, 10^fit, color=as.factor(sp), linetype=as.factor(n.form)))
ggplot(subset(try, subset=pred=="n.form")) + facet_grid(pred~n.form) +
geom_smooth(aes(n.form, 10^fit, color=as.factor(n.psi), linetype=as.factor(sp)))
ggplot(subset(try, subset=pred=="n.form")) + facet_grid(pred~n.psi) +
geom_smooth(aes(n.form, 10^fit, color=as.factor(n.psi), linetype=as.factor(sp)))
ggplot(subset(try, subset=pred=="n.form")) + facet_grid(pred~sp) +
geom_smooth(aes(n.form, 10^fit, color=as.factor(n.psi), linetype=as.factor(sp)))
View(try)
summary(m.whole)
m.form3 <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="3")); summary(m.form3)
m.form6 <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="6")); summary(m.form3)
m.form9 <- lm(log10(runtime) ~ poly(log10(sp),3)*g,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="9")); summary(m.form3)
m.form9 <- lm(log10(runtime) ~ poly(log10(sp),3)*n.psi,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="9")); summary(m.form3)
m.form9 <- lm(log10(runtime) ~ poly(log10(sp),3)*n.psi,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="9")); summary(m.form3)
m.form9 <- lm(log10(runtime) ~ poly(log10(sp),3)*n.psi,
data=outframe %>%
mutate(g=paste(n.form, n.psi, sep="~")) %>%
subset(subset=n.form=="9")); summary(m.form9)
